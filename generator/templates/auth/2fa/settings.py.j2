"""
Two-Factor Authentication Settings for {{ project.name }}

Generated by Django Enhanced Generator on {{ now().strftime('%Y-%m-%d %H:%M:%S') }}.
"""
import os

# Two-factor authentication settings
TWO_FACTOR_PATCH_ADMIN = True
TWO_FACTOR_LOGIN_URL = 'two_factor:login'
TWO_FACTOR_LOGIN_REDIRECT_URL = '/'
TWO_FACTOR_LOGOUT_REDIRECT_URL = '/'

# Authentication methods
TWO_FACTOR_CALL_GATEWAY = None  # Configure for phone calls
TWO_FACTOR_SMS_GATEWAY = None   # Configure for SMS

{% if 'sms' in methods %}
# Twilio configuration for SMS
TWO_FACTOR_SMS_GATEWAY = 'two_factor.gateways.twilio.gateway.Twilio'
TWILIO_ACCOUNT_SID = os.environ.get('TWILIO_ACCOUNT_SID')
TWILIO_AUTH_TOKEN = os.environ.get('TWILIO_AUTH_TOKEN')
TWILIO_CALLER_ID = os.environ.get('TWILIO_PHONE_NUMBER')
{% endif %}

{% if 'email' in methods %}
# Email token settings
TWO_FACTOR_EMAIL_GATEWAY = 'authentication.gateways.EmailGateway'
{% endif %}

# TOTP settings
TWO_FACTOR_TOTP_DIGITS = 6
TWO_FACTOR_TOTP_PERIOD = 30  # seconds

# Backup codes
{% if backup_codes %}
TWO_FACTOR_BACKUP_CODES_ENABLED = True
TWO_FACTOR_BACKUP_CODES_COUNT = 10
{% else %}
TWO_FACTOR_BACKUP_CODES_ENABLED = False
{% endif %}

# Remember device
{% if remember_device %}
TWO_FACTOR_REMEMBER_DEVICE = True
TWO_FACTOR_REMEMBER_DEVICE_DAYS = 30
{% else %}
TWO_FACTOR_REMEMBER_DEVICE = False
{% endif %}

# QR code settings
TWO_FACTOR_QR_FACTORY = 'qrcode.image.svg.SvgPathImage'

# Middleware settings (if enforcing 2FA)
TWO_FACTOR_FORCE_SETUP_PATH = 'two_factor:setup'
TWO_FACTOR_EXEMPT_PATHS = [
    '/api/',  # Exempt API endpoints
    '/static/',
    '/media/',
]